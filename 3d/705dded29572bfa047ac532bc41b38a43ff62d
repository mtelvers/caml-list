Received: from Hermes.metastack.local (172.16.0.8) by Hermes.metastack.local
 (172.16.0.8) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id 15.1.2507.32 via Mailbox
 Transport; Fri, 1 Dec 2023 09:26:27 +0000
Received: from Hermes.metastack.local (172.16.0.8) by Hermes.metastack.local
 (172.16.0.8) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id 15.1.2507.32; Fri, 1 Dec
 2023 09:26:27 +0000
Received: from exchange.romulus.metastack.com (172.16.0.21) by
 Hermes.metastack.local (172.16.0.8) with Microsoft SMTP Server
 (version=TLS1_0, cipher=TLS_RSA_WITH_AES_256_CBC_SHA) id 15.1.2507.32 via
 Frontend Transport; Fri, 1 Dec 2023 09:26:27 +0000
Received: from romulus.metastack.com ([172.16.0.20])
	by exchange.romulus.metastack.com (8.14.2/8.14.2) with ESMTP id 3B19QVMT026873
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <dra@metastack.local>; Fri, 1 Dec 2023 09:26:32 GMT
Received: from mail2-relais-roc.national.inria.fr (mail2-relais-roc.national.inria.fr [192.134.164.83])
	by romulus.metastack.com (8.14.2/8.14.2) with ESMTP id 3B19QO8F026857
	for <dra-news@metastack.com>; Fri, 1 Dec 2023 09:26:25 GMT
Received: from prod-listesu18.inria.fr (HELO sympa.inria.fr) ([128.93.162.160])
  by mail2-relais-roc.national.inria.fr with ESMTP; 01 Dec 2023 10:26:23 +0100
Received: by sympa.inria.fr (Postfix, from userid 20132)
	id 2F105E0CD2; Fri,  1 Dec 2023 10:26:23 +0100 (CET)
Received: from mail2-relais-roc.national.inria.fr (mail2-relais-roc.national.inria.fr [192.134.164.83])
	by sympa.inria.fr (Postfix) with ESMTPS id 427EFE0AF1
	for <caml-list@sympa.inria.fr>; Fri,  1 Dec 2023 10:26:16 +0100 (CET)
Received: from zcs-store1.inria.fr ([128.93.142.28])
  by mail2-relais-roc.national.inria.fr with ESMTP; 01 Dec 2023 10:26:16 +0100
From: Florian Angeletti <florian.angeletti@inria.fr>
To: caml-list <caml-list@inria.fr>
Subject: [Caml-list] First release candidate of OCaml 5.1.1
Thread-Topic: First release candidate of OCaml 5.1.1
Thread-Index: /UG4z7Ft1wqIPPZH9rFkYUwv3zqBag==
Sender: "caml-list-request@inria.fr" <caml-list-request@inria.fr>
X-MS-Exchange-MessageSentRepresentingType: 2
Date: Fri, 1 Dec 2023 09:26:16 +0000
Message-ID: <149603083.31473502.1701422776054.JavaMail.zimbra@inria.fr>
Keywords: Sent to dra-news@metastack.com,Marked bulk,MetaStack -
 Lists,MetaStack
List-Help: <mailto:sympa_inria@inria.fr?subject=help>
List-Subscribe: <mailto:sympa_inria@inria.fr?subject=subscribe%20caml-list>
List-Unsubscribe:
	<mailto:sympa_inria@inria.fr?subject=unsubscribe%20caml-list>
Reply-To: Florian Angeletti <florian.angeletti@inria.fr>
Content-Language: en-GB
X-MS-Exchange-Organization-AuthAs: Anonymous
X-MS-Exchange-Organization-AuthSource: Hermes.metastack.local
X-MS-Has-Attach:
X-Auto-Response-Suppress: All
X-MS-Exchange-Organization-Network-Message-Id:
	7dd4d008-55ac-49f3-cd1b-08dbf24f9810
X-MS-TNEF-Correlator:
X-MS-Exchange-Organization-RecordReviewCfmType: 0
x-scanned-by: MIMEDefang 2.65 on 62.31.23.242
x-originating-ip: [128.93.64.106]
received-spf: None (mail2-relais-roc.national.inria.fr: no sender
  authenticity information available from domain of
  postmaster@sympa.inria.fr) identity=helo;  client-ip=128.93.162.160;
  receiver=mail2-relais-roc.national.inria.fr;
  envelope-from="caml-list-owner@inria.fr";
  x-sender="postmaster@sympa.inria.fr"; x-conformance=spf_only
x-ironport-av: E=Sophos;i="6.04,241,1695679200";
    d="scan'208,217";a="139604713"
x-loop: caml-list@inria.fr
x-no-archive: yes
Content-Type: text/html; charset="iso-8859-1"
Content-ID: <0F69C9CD79858D4A9F8D1738ABE84B5B@metastack.local>
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

<html>
<head>
<meta http-equiv=3D"Content-Type" content=3D"text/html; charset=3Diso-8859-=
1">
</head>
<body>
<div style=3D"font-family: arial, helvetica, sans-serif; font-size: 12pt; c=
olor: #000000">
<div>Dear OCaml users,<br>
<br>
Two months (and half) after the release of OCaml 5.1.0, we have discovered =
three<br>
significant regressions in OCaml 5.1.0, affecting the packaging of executab=
les,<br>
the typechecking of OCaml programs, and the performance of numerical codes.=
<br>
<br>
Since those regressions affect many users and could have lasting effects, w=
e<br>
have decided to cut a patch release of OCaml 5.1 with fixes for those issue=
s</div>
<div>next week.<br>
<br>
To give time for opam packages to test this patch version, we<br>
have just published a first release candidate for OCaml 5.1.1 .<br>
The full list of changes in this release candidate is available below.<br>
<br>
As a major exception to our policy for patch releases, OCaml 5.1.1 will<br>
contain one breaking change in the standard library: the `Compression` flag=
 has<br>
been removed from the `Marshal` module.<br>
This drastic measure was taken because supporting zstd compression in the<b=
r>
standard library made zstd a dependency of all OCaml executables. Since the=
<br>
compiler should not impose its dependency on end-users, the support for<br>
compressed marshaling has been moved to a compiler internal library in 5.1.=
1.<br>
This internally library might be released as an independent library in late=
r<br>
releases of OCaml but not in OCaml 5.1.1 to give us time to polish the libr=
ary<br>
integration and packaging.<br>
<br>
Happy hacking,<br>
Florian Angeletti for the OCaml team.<br>
<br>
<br>
Installation Instructions<br>
--------------------------<br>
<br>
The base compiler can be installed as an opam switch with the following com=
mands on opam 2.1 and later:<br>
<br>
&nbsp;&nbsp;&nbsp; opam update<br>
&nbsp;&nbsp;&nbsp; opam switch create 5.1.1~rc1<br>
<br>
The source code for the release candidate is also directly available on:<br=
>
<br>
* GitHub: https://github.com/ocaml/ocaml/archive/5.1.1-rc1.tar.gz<br>
* OCaml archives at Inria: https://caml.inria.fr/pub/distrib/ocaml-5.1/ocam=
l-5.1.1~rc1.tar.gz<br>
<br>
### Fine-Tuned Compiler Configuration<br>
<br>
If you want to tweak the configuration of the compiler, you can switch to t=
he option variant with:<br>
<br>
&nbsp;&nbsp;&nbsp; opam update<br>
&nbsp;&nbsp;&nbsp; opam switch create &lt;switch_name&gt; ocaml-variants.5.=
1.1~rc1&#43;options &lt;option_list&gt;<br>
<br>
where `option_list` is a space-separated list of `ocaml-option-*` packages.=
 For instance, for a `flambda` and `no-flat-float-array` switch:<br>
<br>
&nbsp;&nbsp;&nbsp; opam switch create 5.1.1~rc1&#43;flambda&#43;nffa ocaml-=
variants.5.1.1~rc1&#43;options ocaml-option-flambda ocaml-option-no-flat-fl=
oat-array<br>
<br>
All available options can be listed with `opam search ocaml-option`.<br>
<br>
<br>
Changes in OCaml 5.1.1<br>
-----------------------<br>
<br>
### Standard Library Dependency Fix:<br>
<br>
* (*breaking change*) [#12562](https://github.com/ocaml/ocaml/issues/12562)=
, [#12734](https://github.com/ocaml/ocaml/issues/12734), [#12783](https://g=
ithub.com/ocaml/ocaml/issues/12783): Remove the `Marshal.Compression` flag =
to the<br>
&nbsp; `Marshal.to_*` functions introduced in 5.1 by [#12006](https://githu=
b.com/ocaml/ocaml/issues/12006), as it cannot<br>
&nbsp; be implemented without risking to link -lzstd with all<br>
&nbsp; ocamlopt-generated executables.&nbsp; The compilers are still able t=
o use<br>
&nbsp; ZSTD compression for compilation artefacts.<br>
&nbsp; (Xavier Leroy and David Allsopp, report by Kate Deplaix, review by<b=
r>
&nbsp;&nbsp; Nicol=E1s Ojeda B=E4r, Kate Deplaix, and Damien Doligez).<br>
<br>
### Type System Bug Fix:<br>
<br>
- [#12623](https://github.com/ocaml/ocaml/issues/12623), fix the computatio=
n of variance composition<br>
&nbsp; (Florian Angeletti, report by Vesa Karvonen, review by Gabriel Scher=
er)<br>
<br>
### GC Performance Regression Fixes<br>
<br>
- [#12590](https://github.com/ocaml/ocaml/issues/12590), [#12595](https://g=
ithub.com/ocaml/ocaml/issues/12595): Move `caml_collect_gc_stats_sample` in=
<br>
&nbsp; `caml_empty_minor_heap_promote` before barrier arrival.<br>
&nbsp; (B. Szilvasy, review by Gabriel Scherer)<br>
<br>
- [#12318](https://github.com/ocaml/ocaml/issues/12318): GC: simplify the m=
eaning of custom_minor_max_size: blocks with<br>
&nbsp; out-of-heap memory above this limit are now allocated directly in<br=
>
&nbsp; the major heap.<br>
&nbsp; (Damien Doligez, report by Stephen Dolan, review by Gabriel Scherer)=
<br>
<br>
- [#12439](https://github.com/ocaml/ocaml/issues/12439): Finalize and colle=
ct dead custom blocks during minor collection<br>
&nbsp; (Damien Doligez, review by Xavier Leroy, Gabriel Scherer and KC<br>
&nbsp; Sivaramakrishnan)<br>
<br>
- [#12491](https://github.com/ocaml/ocaml/issues/12491), [#12493](https://g=
ithub.com/ocaml/ocaml/issues/12493), [#12500](https://github.com/ocaml/ocam=
l/issues/12500), [#12754](https://github.com/ocaml/ocaml/issues/12754): Do =
not change GC pace when creating<br>
&nbsp; sub-arrays of bigarrays<br>
&nbsp; (Xavier Leroy, report by Ido Yariv, analysis by Gabriel Scherer,<br>
<br>
### Miscellaneous Bug Fixes<br>
<br>
- [#12581](https://github.com/ocaml/ocaml/issues/12581), [#12609](https://g=
ithub.com/ocaml/ocaml/issues/12609): Fix error on uses of packed modules ou=
tside their pack<br>
&nbsp; to correctly handle nested packs<br>
&nbsp; (Vincent Laviron, report by Javier Ch=E1varri, review by Pierre Cham=
bart)<br>
<br>
- [#12757](https://github.com/ocaml/ocaml/issues/12757): Fix ocamlnat (nati=
ve toplevel) by registering frametables correctly<br>
&nbsp; (Stephen Dolan, Nick Barnes and Mark Shinwell,<br>
&nbsp;&nbsp; review by Vincent Laviron and S=E9bastien Hinderer)<br>
<br data-mce-bogus=3D"1">
</div>
<div>- [#12645](https://github.com/ocaml/ocaml/issues/12645), [#12649](http=
s://github.com/ocaml/ocaml/issues/12649) fix error messages for cyclic type=
 definitions in presence of<br>
&nbsp; the `-short-paths` flag.<br>
&nbsp; (Florian Angeletti, report by Vesa Karvonen, review by Gabriel Scher=
er)<br>
<br>
</div>
</div>
</body>
</html>
