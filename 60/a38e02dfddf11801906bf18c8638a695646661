Received: from Hermes.metastack.local (172.16.0.8) by Hermes.metastack.local
 (172.16.0.8) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id 15.1.2507.32 via Mailbox
 Transport; Fri, 8 Dec 2023 08:36:56 +0000
Received: from Hermes.metastack.local (172.16.0.8) by Hermes.metastack.local
 (172.16.0.8) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id 15.1.2507.32; Fri, 8 Dec
 2023 08:36:56 +0000
Received: from exchange.romulus.metastack.com (172.16.0.21) by
 Hermes.metastack.local (172.16.0.8) with Microsoft SMTP Server
 (version=TLS1_0, cipher=TLS_RSA_WITH_AES_256_CBC_SHA) id 15.1.2507.32 via
 Frontend Transport; Fri, 8 Dec 2023 08:36:56 +0000
Received: from romulus.metastack.com ([172.16.0.20])
	by exchange.romulus.metastack.com (8.14.2/8.14.2) with ESMTP id 3B88b3Nd022854
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <dra@metastack.local>; Fri, 8 Dec 2023 08:37:03 GMT
Received: from mail2-relais-roc.national.inria.fr (mail2-relais-roc.national.inria.fr [192.134.164.83])
	by romulus.metastack.com (8.14.2/8.14.2) with ESMTP id 3B88atPF022835
	for <dra-news@metastack.com>; Fri, 8 Dec 2023 08:36:55 GMT
Received: from prod-listesu18.inria.fr (HELO sympa.inria.fr) ([128.93.162.160])
  by mail2-relais-roc.national.inria.fr with ESMTP; 08 Dec 2023 09:36:54 +0100
Received: by sympa.inria.fr (Postfix, from userid 20132)
	id 43BCEE0D64; Fri,  8 Dec 2023 09:36:54 +0100 (CET)
Received: from mail2-relais-roc.national.inria.fr (mail2-relais-roc.national.inria.fr [192.134.164.83])
	by sympa.inria.fr (Postfix) with ESMTPS id A9984E00B7
	for <caml-list@sympa.inria.fr>; Fri,  8 Dec 2023 09:36:51 +0100 (CET)
Received: from web.is.ocha.ac.jp ([133.65.64.10])
  by mail2-smtp-roc.national.inria.fr with ESMTP; 08 Dec 2023 09:36:48 +0100
Received: from mail-pl1-f200.google.com (mail-pl1-f200.google.com [209.85.214.200])
	by web.is.ocha.ac.jp (Postfix) with ESMTP id 0325336005B
	for <caml-list@inria.fr>; Fri,  8 Dec 2023 17:36:37 +0900 (JST)
Received: by mail-pl1-f200.google.com with SMTP id d9443c01a7336-1d1d8b65489so20592265ad.0
        for <caml-list@inria.fr>; Fri, 08 Dec 2023 00:36:36 -0800 (PST)
Received: from localhost ([133.65.65.2])
        by smtp.gmail.com with ESMTPSA id g14-20020a1709029f8e00b001cf7c07be50sm1127034plq.58.2023.12.08.00.36.35
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Fri, 08 Dec 2023 00:36:35 -0800 (PST)
From: Kenichi Asai <asai@is.ocha.ac.jp>
To: "caml-list@inria.fr" <caml-list@inria.fr>
Subject: [Caml-list] jsoo toplevel with ppx_deriving.show support?
Thread-Topic: [Caml-list] jsoo toplevel with ppx_deriving.show support?
Thread-Index: AQHaKbG0DctigMaH3kuWnuSHhLvr+g==
Sender: "caml-list-request@inria.fr" <caml-list-request@inria.fr>
X-MS-Exchange-MessageSentRepresentingType: 2
Date: Fri, 8 Dec 2023 08:36:23 +0000
Message-ID: <ZXLVh9J9LLXH7W5H@pllab.is.ocha.ac.jp>
Keywords: Sent to dra-news@metastack.com,Marked bulk,MetaStack -
 Lists,MetaStack
List-Help: <mailto:sympa_inria@inria.fr?subject=help>
List-Subscribe: <mailto:sympa_inria@inria.fr?subject=subscribe%20caml-list>
List-Unsubscribe:
	<mailto:sympa_inria@inria.fr?subject=unsubscribe%20caml-list>
Reply-To: Kenichi Asai <asai@is.ocha.ac.jp>
Content-Language: en-GB
X-MS-Exchange-Organization-AuthAs: Anonymous
X-MS-Exchange-Organization-AuthSource: Hermes.metastack.local
X-MS-Has-Attach: yes
X-Auto-Response-Suppress: All
X-MS-Exchange-Organization-Network-Message-Id:
	b2e847e8-b056-444f-9b6e-08dbf7c8d68e
X-MS-TNEF-Correlator:
X-MS-Exchange-Organization-RecordReviewCfmType: 0
x-scanned-by: MIMEDefang 2.65 on 62.31.23.242
x-received: by 2002:a17:902:a501:b0:1d0:6ffd:e2bc with SMTP id
 s1-20020a170902a50100b001d06ffde2bcmr3789067plq.86.1702024595778;        Fri,
 08 Dec 2023 00:36:35 -0800 (PST)
received-spf: None (mail2-relais-roc.national.inria.fr: no sender
  authenticity information available from domain of
  postmaster@sympa.inria.fr) identity=helo;  client-ip=128.93.162.160;
  receiver=mail2-relais-roc.national.inria.fr;
  envelope-from="caml-list-owner@inria.fr";
  x-sender="postmaster@sympa.inria.fr"; x-conformance=spf_only
x-ironport-av: E=Sophos;i="6.04,260,1695679200";
    d="ml'?html'217?scan'217,208,217";a="141135595"
x-ironport-anti-spam-filtered: true
x-loop: caml-list@inria.fr
x-no-archive: yes
Content-Type: multipart/mixed;
	boundary="_005_ZXLVh9J9LLXH7W5Hpllabisochaacjp_"
MIME-Version: 1.0

--_005_ZXLVh9J9LLXH7W5Hpllabisochaacjp_
Content-Type: text/plain; charset="us-ascii"
Content-ID: <DBCDD11E81DFBF459765E1384ED05840@metastack.local>

I want to have an OCaml toplevel in a browser having ppx_deriving.show
support.  I tried to include "ppx_deriving.show" as in the attached
dune file, but the resulting toplevel does not appear to understand
[@@deriving show] directive.

With the attached files, I can at least print a message in a browser:

- create a directory
- save the attached four files
- dune build
- open index.html

In index.html, I run the toplevel with

print_endline "hello";;

and 

type test_t = {x:int}[@@deriving show];;
print_endline (show_test_t {x=1});;

The former succeeds, but the latter produces:

Error: Unbound value show_test_t

How can I create an OCaml toplevel that produces

{ x = 1 }
- : unit = ()

for the latter?  Thank you in advance!

Sincerely,

-- 
Kenichi Asai

--_005_ZXLVh9J9LLXH7W5Hpllabisochaacjp_
Content-Type: text/plain; name="dune"
Content-Description: dune
Content-Disposition: attachment; filename="dune"; size=936;
	creation-date="Fri, 08 Dec 2023 08:36:57 GMT";
	modification-date="Fri, 08 Dec 2023 08:36:57 GMT"
Content-ID: <45ED63F14EC784449F891ACE194F2DC0@metastack.local>
Content-Transfer-Encoding: base64

KGV4ZWN1dGFibGVzDQogIChuYW1lcyBldmFsKQ0KICAobGlicmFyaWVzDQogICAgcHB4X2Rlcml2
aW5nLnNob3cNCiAgICBqc19vZl9vY2FtbC1jb21waWxlcg0KICAgIGpzX29mX29jYW1sLXRvcGxl
dmVsKQ0KICAobGlua19mbGFncyAoOnN0YW5kYXJkIC1saW5rYWxsKSkNCiAgKHByZXByb2Nlc3Mg
KHBwcyBqc19vZl9vY2FtbC1wcHggcHB4X2Rlcml2aW5nLnNob3cpKSkNCg0KKHJ1bGUNCiAodGFy
Z2V0cyBleHBvcnQudHh0KQ0KIChkZXBzIGV2YWwuYmMpDQogKGFjdGlvbiAocnVuIGpzb29fbGlz
dHVuaXRzIC1vICV7dGFyZ2V0c30gc3RkbGliKSkpDQoNCihydWxlDQogKHRhcmdldHMgZXZhbC5q
cykNCiAoYWN0aW9uDQogICAgKHJ1biAle2Jpbjpqc19vZl9vY2FtbH0NCgkgIC0tZXhwb3J0ICV7
ZGVwOmV4cG9ydC50eHR9DQogICAgICAgICAgLS10b3BsZXZlbA0KICAgICAgICAgIC0tbm9ydW50
aW1lDQoJICAle2xpYjpqc19vZl9vY2FtbC1jb21waWxlcjpydW50aW1lLmpzfQ0KCSAgJXtsaWI6
anNfb2Zfb2NhbWwtY29tcGlsZXI6dG9wbGV2ZWwuanN9DQogICAgICAgICAgJXtsaWI6anNfb2Zf
b2NhbWwtY29tcGlsZXI6ZHlubGluay5qc30NCiAgICAgICAgICAle2RlcDpldmFsLmJjfQ0KCSAg
LW8gJXt0YXJnZXRzfQ0KICAgICAgICAgICkpKQ0KDQooYWxpYXMNCiAgKG5hbWUgZGVmYXVsdCkN
CiAgKGRlcHMgZXZhbC5qcykpDQo=

--_005_ZXLVh9J9LLXH7W5Hpllabisochaacjp_
Content-Type: text/plain; name="dune-project"
Content-Description: dune-project
Content-Disposition: attachment; filename="dune-project"; size=289;
	creation-date="Fri, 08 Dec 2023 08:36:57 GMT";
	modification-date="Fri, 08 Dec 2023 08:36:57 GMT"
Content-ID: <CE1860BB6F98C442B0AD9D449CB9BD90@metastack.local>
Content-Transfer-Encoding: base64

KGxhbmcgZHVuZSAxLjIpDQo=

--_005_ZXLVh9J9LLXH7W5Hpllabisochaacjp_
Content-Type: text/plain; name="eval.ml"
Content-Description: eval.ml
Content-Disposition: attachment; filename="eval.ml"; size=1715;
	creation-date="Fri, 08 Dec 2023 08:36:57 GMT";
	modification-date="Fri, 08 Dec 2023 08:36:57 GMT"
Content-ID: <ED907FBD8912734788D313E7D35F49D7@metastack.local>
Content-Transfer-Encoding: base64

KCogc2VlOiBodHRwczovL2tob2FuZ3V5ZW4ubWUvc2tldGNoL3BhcnQtMi10aGUtZW5naW5lLyAq
KQ0KDQpvcGVuIEpzX29mX29jYW1sX3RvcGxldmVsDQpvcGVuIEpzX29mX29jYW1sDQoNCmxldCBl
eGVjdXRlIGNvZGUgPQ0KICBsZXQgY29kZSA9IEpzX29mX29jYW1sLkpzLnRvX3N0cmluZyBjb2Rl
IGluDQogIGxldCBidWZmZXIgPSBCdWZmZXIuY3JlYXRlIDEwMCBpbg0KICBsZXQgZm9ybWF0dGVy
ID0gRm9ybWF0LmZvcm1hdHRlcl9vZl9idWZmZXIgYnVmZmVyIGluDQogIEpzb29Ub3AuZXhlY3V0
ZSB0cnVlIGZvcm1hdHRlciBjb2RlOw0KICBKc19vZl9vY2FtbC5Kcy5zdHJpbmcgKEJ1ZmZlci5j
b250ZW50cyBidWZmZXIpDQoNCmxldCBhcHBlbmRfc3RyaW5nIG91dHB1dCBjbCBzID0NCiAgbGV0
IG9wZW4gSnNfb2Zfb2NhbWwgaW4NCiAgbGV0IGQgPSBEb21faHRtbC53aW5kb3cjIy5kb2N1bWVu
dCBpbg0KICBsZXQgc3BhbiA9IERvbV9odG1sLmNyZWF0ZURpdiBkIGluDQogIHNwYW4jIy5jbGFz
c0xpc3QjI2FkZCAoSnMuc3RyaW5nIGNsKTsNCiAgRG9tLmFwcGVuZENoaWxkIHNwYW4gKGQjI2Ny
ZWF0ZVRleHROb2RlIChKcy5zdHJpbmcgcykpOw0KICBEb20uYXBwZW5kQ2hpbGQgb3V0cHV0IHNw
YW4NCg0KbGV0IG9jYW1sSW5pdFByb2dyYW0gPQ0KImxldCBfbXlfcHJpbnRlcl8gcHBmID0gRm9y
bWF0LmZwcmludGYgcHBmIFwiXFxcIiVzXFxcIlwiOzsNCiNpbnN0YWxsX3ByaW50ZXIgX215X3By
aW50ZXJfOzsNCiINCg0KbGV0IHJ1bkNvZGUgc3RyID0NCiAgbGV0IHRvcGxvb3BfID0gb3Blbl9v
dXQgIi9kZXYvbnVsbCIgaW4NCiAgbGV0IHRvcGxvb3BfcHBmID0gRm9ybWF0LmZvcm1hdHRlcl9v
Zl9vdXRfY2hhbm5lbCB0b3Bsb29wXyBpbg0KICBKc29vVG9wLmluaXRpYWxpemUgKCk7DQogIGxl
dCBkb20gPSBEb21faHRtbC5nZXRFbGVtZW50QnlJZCAidG9wbGV2ZWwiIGluDQogIFN5c19qcy5z
ZXRfY2hhbm5lbF9mbHVzaGVyIHN0ZG91dCAoYXBwZW5kX3N0cmluZyBkb20gInN0ZG91dCIpOw0K
ICBTeXNfanMuc2V0X2NoYW5uZWxfZmx1c2hlciBzdGRlcnIgKGFwcGVuZF9zdHJpbmcgZG9tICJz
dGRlcnIiKTsNCiAgbGV0IF9yZXQgPSBKc29vVG9wLmV4ZWN1dGUgdHJ1ZSB0b3Bsb29wX3BwZiBv
Y2FtbEluaXRQcm9ncmFtIGluDQogIFN5c19qcy5zZXRfY2hhbm5lbF9mbHVzaGVyIHRvcGxvb3Bf
IChhcHBlbmRfc3RyaW5nIGRvbSAidG9wbG9vcCIpOw0KICBsZXQgdHh0ID0gSnMudG9fc3RyaW5n
IHN0ciBpbg0KICBsZXQgX3JldCA9IEpzb29Ub3AuZXhlY3V0ZSB0cnVlIHRvcGxvb3BfcHBmIHR4
dCBpbg0KICAoKQ0KDQpsZXQgKCkgPQ0KICBKc29vVG9wLmluaXRpYWxpemUgKCk7DQogIEpzX29m
X29jYW1sLkpzLmV4cG9ydA0KICAgICJldmFsdWF0b3IiDQogICAgKG9iamVjdCVqcw0KICAgICAg
IHZhbCBydW5Db2RlID0gcnVuQ29kZQ0KICAgIGVuZCkNCg==

--_005_ZXLVh9J9LLXH7W5Hpllabisochaacjp_
Content-Type: text/html; name="index.html"
Content-Description: index.html
Content-Disposition: attachment; filename="index.html"; size=755;
	creation-date="Fri, 08 Dec 2023 08:36:57 GMT";
	modification-date="Fri, 08 Dec 2023 08:36:57 GMT"
Content-ID: <46D044F31E48F94A8C516006841B896E@metastack.local>
Content-Transfer-Encoding: base64

PCFET0NUWVBFIGh0bWw+DQo8aHRtbD4NCiAgPGhlYWQ+DQogICAgPG1ldGEgY2hhcnNldD0idXRm
LTgiPg0KICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9Il9idWlsZC9kZWZh
dWx0L2V2YWwuanMiPjwvc2NyaXB0Pg0KICA8L2hlYWQ+DQogIDxib2R5Pg0KICAgIDxkaXYgaWQ9
InRvcGxldmVsIj48L2Rpdj4NCiAgICA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+DQog
ICAgICBldmFsdWF0b3IucnVuQ29kZSgncHJpbnRfZW5kbGluZSAiaGVsbG8iOztcbicpOw0KICAg
IDwvc2NyaXB0Pg0KICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4NCiAgICAgIGV2
YWx1YXRvci5ydW5Db2RlKCd0eXBlIHRlc3RfdCA9IHt4OmludH1bQEBkZXJpdmluZyBzaG93XTs7
IHByaW50X2VuZGxpbmUgKHNob3dfdGVzdF90IHt4PTF9KTs7XG4nKTsNCiAgICA8L3NjcmlwdD4N
CiAgPC9ib2R5Pg0KPC9odG1sPg0K

--_005_ZXLVh9J9LLXH7W5Hpllabisochaacjp_--
